; Configuration file for Duet WiFi (firmware version 2.03)
; executed by the firmware on start-up
;
; generated by RepRapFirmware Configuration Tool v2.0.5 on Mon Oct 21 2019 00:00:01 GMT+0200 (Central European Summer Time)

; General preferences
G90                                        ; send absolute coordinates...
M83                                        ; ...but relative extruder moves
M550 P"H-Bot"                              ; set printer name

M667 S1                                    ; select CoreXY mode

; Network
M551 P"Sebastian0"                         ; Set password
M552 S1                                    ; Enable network
M586 P0 S1                                 ; Enable HTTP
M586 P1 S0                                 ; Disable FTP
M586 P2 S0                                 ; Disable Telnet
M586 P2 S0                                 ; disable Telnet

; Drives
M569 P0 S1                                 ; physical drive 0 goes forwards
M569 P1 S1                                 ; physical drive 1 goes forwards
M569 P2 S1                                 ; physical drive 2 goes forwards Z
M569 P3 S0                                 ; physical drive 3 goes backwards E0
M569 P5 S0 								   ; Drive 5 E1 backwars
M569 P7 S0 								   ; Drive 7 COUPLER
M569 P9 S0                                 ; physical drive 9 goes forwards	Z
M584 X0 Y1 C7 Z2:4:9 E3:5                         ; set drive mapping (z motors are connected to Z, E1 and E6 drivers for auto bed tramming)
M92 X160.00 Y160.00 C91.022 Z1600.00 E416.97628180663366:407.2610690055072         ;(Z was 400) set steps per mm for default 16x microstepping , dual drive:416.97628180663366
M350 X16 Y16 Z16 E16:16 I1                    ; configure microstepping with interpolation (8x for x,y (0.9deg motors)?)
M350 C16 I10											; Configure microstepping without interpolation
M566 X600.00 Y600.00 C2 Z12.00 E500.00:500.00        ; set maximum instantaneous speed changes (mm/min) was X900 Y900 E120
M203 X35000.00 Y35000.00 C10000 Z600.00 E10000.00:10000.00 ; set maximum speeds (mm/min) was X25000 Y25000 Z500
M201 X6000.00 Y6000.00 C1000 Z300.00 E4000.00:4000.00       ; set accelerations (mm/s^2) was X4000 Y4000 E1500 Z150
M906 X1200 Y1200 Z800 I30             ; set motor currents (mA) and motor idle factor in per cent
M906 E800:800 C500 I10     						; Idle extruder motors to 10%, Extruder 0 bondtech lgx max 700mA per intructions
M84 S30                                    ; Set idle timeout

;auto bed tramming
M671 X110:259:-39 Y256:-17:-17 S10 	 	  	   ; leadscrews at left-front (connected to drive 9) and right-front (connected to E1) and back (connected to Z)

; Axis Limits
M208 X-13 Y0 Z0 C-45 S1                           ; set axis minima
M208 X210 Y300 Z200 C360 S0                     ; set axis maxima 

; Endstops
M574 X2 S1 P"xstop"                            ;X min active low endstop switch
M574 Y1 S1 P"ystop"	   							;Y min active low endstop switch
M574 C0 Z0  									;no c,z-axis endstop

; Z-Probe
M558 P8 C"zstop" H3 F360 I0 T20000 	; Set Z probe type to switch, the axes for which it is used and the dive height + speeds
G31 P200 X0 Y0 Z0	 				; Set Z probe trigger value, offset and trigger height
M556 S50 X0 Y0 Z0                          			; set orthogonal axis compensation parameters
M557 X15:205 Y15:195 S36                   			; define mesh grid


; Heaters
M308 S0 P"bedtemp" Y"thermistor" T100000 B4725 C7.060000e-8 R4700   	; define heated bed temperature sensor
M950 H0 C"bedheat" T0 									; heater 0 uses the bed_heat pin, sensor 0
M140 H0 												; the bed heater is heater 0
M143 H0 S120                               				; set temperature limit for heater 0 to 120C

M308 S1 P"e0temp" Y"thermistor" T100000 B4725 C7.06e-8   	; define e0 temperature sensor
M950 H1 C"duex.e3heat" T1 									; heater 1 uses the duex.e3heat pin and sensor 1
M143 H1 S280                               				; set temperature limit for heater 1 to 280C

M308 S3 P"e3temp" Y"thermistor" T100000 B4725 C7.06e-8 R4700   	; define e1 temperature sensor
M950 H3 C"duex.e2heat" T3 									; heater 3 uses the duex.e2_heat pin and sensor 3
M143 H3 S300                               					; set temperature limit for heater 3 to 245C


;heated chamber
M308 S2 P"e1temp" Y"thermistor" T100000 B4725 C7.06e-8    		; define chamber temperature sensor
M950 H2 C"e1heat" T2 											; heater 0 uses the bed_heat pin, sensor 2
M301 H2 B1 				   										; use bang-bang control for the chamber heater
M141 H2 				   										; heater 2 is the chamber heater


; Fans
M950 F0 C"fan0" Q500 										; fan 0
M950 F1 C"fan1" Q500 										; fan 1
M106 P1 C"T0-Fan" L0.65 S0.75 H1 T70    					; set fan 0 name, value, PWM signal inversion and frequency. Thermostatic control is turned on
M106 P0 C"T0-Part-Fan" S0     								; set fan 1 name, value, PWM signal inversion and frequency. Thermostatic control is turned off
	
M950 F3 C"duex.fan3"										; fan 3
M950 F4 C"duex.fan4"										; fan 4
M106 P3 C"T1-Fan" L0.65 S0.75 H3 T70										; T1 HE
M106 P4 C"T1-Part-Fan" S0 													; T1 PCF 

; Tools
M563 P0 S"T0" D0 H1 F0:1                   	; define tool 0 with fans 0 and 1 and extruder 0
G10 P0 X0 Y0 Z0                            			; set tool 0 axis offsets
G10 P0 R0 S0                               			; set initial tool 0 active and standby temperatures to 0C

M563 P1 S"T1" D1 H3 F3 					; Define tool 1
G10 P1 X0 Y0 Z0 						; Reset tool 1 axis offsets
G10 P1 R0 S0 							; Reset initial tool 1 active and standby temperatures to 0C

; Tool offset
G10 P0 X-12.3 Y59 Z-4.19					; T0 was Z-3.99
G10 P1 X-12.3 Y49 Z-4.72						; T1


;enable pressure advance for extruder
M572 D0 S0.1 						; pressure advance T0
M572 D1 S0.1 						; pressure advance T1

; Custom settings
;define min/max coordinates
M208 X-17 S1
M208 Y-23 S1
M208 X244 Y251 Z175 ; Z was 250

;rehome and continue after loosing steps (R3)
;just log the motor stall (R1)
;M915 X Y S7 R1 


;disable 24V power supply
M81 C"pson"
;deselect tools 
T-1


