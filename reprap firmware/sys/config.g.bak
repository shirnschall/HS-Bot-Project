; Configuration file for Duet WiFi (firmware version 2.03)
; executed by the firmware on start-up
;
; generated by RepRapFirmware Configuration Tool v2.0.5 on Mon Oct 21 2019 00:00:01 GMT+0200 (Central European Summer Time)

; General preferences
G90                                        ; send absolute coordinates...
M83                                        ; ...but relative extruder moves
M550 P"H-Bot"                              ; set printer name

M667 S1                                    ; select CoreXY mode

; Network
M551 P"Sebastian0"                         ; Set password
M552 S1                                    ; Enable network
M586 P0 S1                                 ; Enable HTTP
M586 P1 S0                                 ; Disable FTP
M586 P2 S0                                 ; Disable Telnet
M586 P2 S0                                 ; disable Telnet

; Drives
M569 P0 S1                                 ; physical drive 0 goes forwards
M569 P1 S1                                 ; physical drive 1 goes forwards
M569 P2 S1                                 ; physical drive 2 goes forwards
M569 P3 S1                                 ; physical drive 3 goes forwards
M569 P5 S1 								   ; Drive 5 E1
M569 P7 S0 								   ; Drive 7 COUPLER
M584 X0 Y1 C7 Z2:4 E3:5                         ; set drive mapping (z motors are connected to Z and E1 drivers for auto bed tramming)
M92 X160.00 Y160.00 C91.022 Z400.00 E421.1460446247:416.5802784977         ; set steps per mm for default 16x microstepping
M350 X16 Y16 Z16 E16:16 I1                    ; configure microstepping with interpolation (8x for x,y (0.9deg motors)?)
M350 C16 I10											; Configure microstepping without interpolation
M566 X900.00 Y900.00 C2 Z12.00 E120.00:120.00        ; set maximum instantaneous speed changes (mm/min) was X900 Y900
M203 X18000.00 Y18000.00 C5000 Z500.00 E1000.00:1000.00 ; set maximum speeds (mm/min)
M201 X800.00 Y500.00 C500 Z20.00 E250.00:250.00       ; set accelerations (mm/s^2)
M906 X1200 Y1200 Z800 I30             ; set motor currents (mA) and motor idle factor in per cent
M906 E1000:1000 C500 I10     						; Idle extruder motors to 10%
M84 S30                                    ; Set idle timeout

;auto bed tramming
M671 X-8:207 Y110:110 S5 	 	  	   ; leadscrews at left (connected to Z) and right (connected to E1)

; Axis Limits
M208 X-13 Y0 Z0 C-45 S1                           ; set axis minima
M208 X210 Y300 Z200 C360 S0                     ; set axis maxima 

; Endstops
M574 X2 S1 P"xstop"                            ;X min active low endstop switch
M574 Y1 S1 P"ystop"	   							;Y min active low endstop switch
M574 C0 Z0  									;no c,z-axis endstop

; Z-Probe
M558 P8 C"zstop" H3 F360 I0 T20000 	; Set Z probe type to switch, the axes for which it is used and the dive height + speeds
G31 P200 X0 Y0 Z0	 				; Set Z probe trigger value, offset and trigger height
M556 S50 X0 Y0 Z0                          			; set orthogonal axis compensation parameters
M557 X15:205 Y15:195 S36                   			; define mesh grid


; Heaters
M308 S0 P"bedtemp" Y"thermistor" T100000 B4725 C7.060000e-8 R4700   	; define heated bed temperature sensor
M950 H0 C"bedheat" T0 									; heater 0 uses the bed_heat pin, sensor 0
M140 H0 												; the bed heater is heater 0
M143 H0 S120                               				; set temperature limit for heater 0 to 120C

M308 S1 P"e0temp" Y"thermistor" T100000 B4725 C7.06e-8   	; define e0 temperature sensor
M950 H1 C"e0heat" T1 									; heater 1 uses the e0_heat pin and sensor 1
M143 H1 S280                               				; set temperature limit for heater 1 to 280C

M308 S3 P"e2temp" Y"thermistor" T100000 B4725 C7.06e-8   	; define e1 temperature sensor
M950 H3 C"duex.e2heat" T3 									; heater 3 uses the duex.e2_heat pin and sensor 3
M143 H3 S245                               					; set temperature limit for heater 2 to 280C


;heated chamber
M308 S2 P"e1temp" Y"thermistor" T100000 B4725 C7.06e-8    		; define chamber temperature sensor
M950 H2 C"e1heat" T2 											; heater 0 uses the bed_heat pin, sensor 2
M301 H2 B1 				   										; use bang-bang control for the chamber heater
M141 H2 				   										; heater 2 is the chamber heater


; Fans
M950 F0 C"fan0" Q500 										; fan 0
M950 F1 C"fan1" Q500 										; fan 1
M106 P1 C"T0-Fan" L0.65 S0.75 H1 T70    					; set fan 0 name, value, PWM signal inversion and frequency. Thermostatic control is turned on
M106 P0 C"T0-Part-Fan" S0 H-1     							; set fan 1 name, value, PWM signal inversion and frequency. Thermostatic control is turned off
	
M950 F3 C"duex.fan3"										; fan 3
M950 F4 C"duex.fan4"										; fan 4
M106 P3 C"T1-Fan" L0.65 S0.75 H3 T70										; T1 HE
M106 P4 C"T1-Part-Fan" S0 H-1 													; T1 PCF 

; Tools
M563 P0 S"T0" D0 H1 F0:1                   	; define tool 0 with fans 0 and 1 and extruder 0
G10 P0 X0 Y0 Z0                            			; set tool 0 axis offsets
G10 P0 R0 S0                               			; set initial tool 0 active and standby temperatures to 0C

M563 P1 S"T1" D1 H3 F3 					; Define tool 1
G10 P1 X0 Y0 Z0 						; Reset tool 1 axis offsets
G10 P1 R0 S0 							; Reset initial tool 1 active and standby temperatures to 0C

; Tool offset
G10 P0 X-9 Y39 Z-4.15					; T0
G10 P1 X-7.6 Y37.2 Z-4.14						; T1


;enable pressure advance for extruder
M572 D0 S0.2 						; pressure advance T0
M572 D1 S0.2 						; pressure advance T1

; Custom settings
;define min/max coordinates
M208 X-31 S1
M208 Y0 S1
M208 X230 Y274 Z150 ; Z was 250

;rehome and continue after loosing steps
M915 X Y S7 R3 


;disable 24V power supply
M81
;deselect tools 
T-1


